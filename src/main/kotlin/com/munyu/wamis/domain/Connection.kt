package com.munyu.wamis.domainimport com.fasterxml.jackson.annotation.JsonIgnorePropertiesimport java.util.ArrayListimport javax.persistence.*@Entitydata class Connection(        @Column(nullable = false)        val meterSerialNumber: String,        @Column(nullable = false,columnDefinition = "TEXT")        val meterLocation: String) : AbstractAuditableEntity(){    @Column(nullable = false)    var connectionCode: String = ""    @Enumerated(EnumType.STRING)    @Column(nullable = true)    var status: ConnectionStatus? = null    @ManyToOne    @JoinColumn(name = "customer_id")    var customer: Customer? = null    @JsonIgnoreProperties("connection")    @OneToMany(mappedBy = "connection",cascade= [CascadeType.ALL])    var readings: MutableList<Reading> = ArrayList()    init {        this.connectionCode = generateConnectionCode()        this.status = ConnectionStatus.INITIAL    }    constructor(serial: String,location: String,status: ConnectionStatus,code: String,customer: Customer,readings: MutableList<Reading> ): this(serial,location){        this.status = status        this.customer = customer        this.readings = readings    }    fun generateConnectionCode(): String{        return (0..9).shuffled().subList(3,6).toString()    }    fun bill(readings: List<Reading>){        this.readings.addAll(readings);        readings.forEach { r ->            if (r.currentReading < r.previousReading){                throw IllegalArgumentException("Previous reading cannot be greater than current reading!")            }            r.connection = this        }    }}